# 单片机stm32的操作和技巧


<!-- @import "[TOC]" {cmd="toc" depthFrom=2 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [〇. 写在前面](#〇-写在前面)
  - [0.1 stm32学习路径](#01-stm32学习路径)
  - [0.2 附件说明](#02-附件说明)
  - [0.3 软件](#03-软件)
  - [0.4 STM32的开发方式](#04-stm32的开发方式)
    - [方法1. 基于寄存器方式](#方法1-基于寄存器方式)
    - [方法2. 基于标准库方式](#方法2-基于标准库方式)
  - [0.x 单片机厂商选择](#0x-单片机厂商选择)
- [一. 开始学习](#一-开始学习)
  - [1.1 认识开发板](#11-认识开发板)
  - [1.2 创建工程](#12-创建工程)
- [二. 文件说明](#二-文件说明)
  - [2.1 启动文件](#21-启动文件)
- [问题解决](#问题解决)
  - [问题解决-STM执行LOAD指令, 出现错误提示No target connected](#问题解决-stm执行load指令-出现错误提示no-target-connected)

<!-- /code_chunk_output -->



## 〇. 写在前面
### 0.1 stm32学习路径
1. 江科大的单片机教程
    + 视频链接: 
        https://www.bilibili.com/video/BV1th411z7sn/?spm_id_from=333.337.search-card.all.click
    + 视频资料:
        > 本文档附件中也有 
        https://jiangxiekeji.com/download.html
    + 教程相关问题及解答:
        https://jiangxiekeji.com/problem.html
    + stm32套件购买:
        https://jiangxiekeji.taobao.com

### 0.2 附件说明
1. 附件1: STM32入门教程资料
    + 资料来源:
        江科大的单片机教程简介中的链接资料
    + 若注册机没有, 去搜索最近的`keil5注册机`资源
    
2. 


### 0.3 软件
1. 软件为Keil5 MDK
    + 软件的安装见上述教程

2. 支持包
    + Keil5 MDK软件版本将各个单片机型号模块化, 使用不同的单片机需要自行安装不同的[支持包]. 
    + 支持包的安装分为 离线安装 和 在线安装
        - 详细流程见上述教程, 都有演示



### 0.4 STM32的开发方式
#### 方法1. 基于寄存器方式
+ 原理: 
    程序之际配置寄存器, 更底层也更高效.
    但stm32的寄存器种类多, 不推荐新手

#### 方法2. 基于标准库方式
> 标准库, 即库函数方式和HAL库的方式
1. 基于库函数方式
    + 就是使用ST官方封装好的函数.
    + 需要ST固件包(见课程资料)

2. 基于HAL库方式
    + 图形界面, 快速上手. 
    + 缺点: 缺少底层逻辑训练.

### 0.x 单片机厂商选择
目前有两个主流厂商**正点原子** 和 **野火**
1. 正点原子:   
    + 比较可靠

2. 野火
    + 创新, 开发板有更多的外设接口
    + 有社区
        - https://www.firebbs.cn/



## 一. 开始学习
### 1.1 认识开发板
1. 当前STM32系统板的芯片型号是
    STM32F103C8T6


### 1.2 创建工程
1. 



## 二. 文件说明
### 2.1 启动文件
1. 作用
    STM32程序并非从C程序的main函数开始, 而是先执行一段汇编进行初始化.
    
2. 分类和特点
    + `.s`为结尾
    + 根据芯片型号进行选择
        | 缩写 | 释义 | Flash容量 | 型号 |
        | - | - | - | - |
        | LD_VL | 小容量产品超值系列 | 16-32K | STM32F100 |
        | MD_VL | 中容量产品超值系列 | 64-128K | STM32F100 |
        | HD_VL | 大容量产品超值系列 | 256-512K | STM32F100 |
        | LD | 小容量产品 | 16-32K | STM32F101/102/103 |
        | MD | 中容量产品 | 64-128K | STM32F101/102/103 |
        | HD | 大容量产品 | 256-512K | STM32F101/102/103 |
        | XL | 加大容量产品 | 大于512K | STM32F101/102/103 |
        | CL | 互联型产品 | - | STM32F105/107 |

        例如江科大教程中选择的启动文件为`startup_stm32f10x_md.s`, 名称中的`md`为中容量产品.
        
3. 使用


## 问题解决
### 问题解决-STM执行LOAD指令, 出现错误提示No target connected
1. 问题原因:
    排线错误
2. 问题解决:
    > 如教程中`[2-2] 新建工程`14min时第一次点灯.   

    第一次尝试因为没注意, 系统板和STLink的插件并不是一个顺序插入的,比如:
    系统板顺序为红橙黄绿, 但是STLink插线顺序并非红橙黄绿.